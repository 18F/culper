!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){function n(e,t){this.count=e,this.dataCodewords=t,Object.defineProperty(this,"Count",{get:function(){return this.count}}),Object.defineProperty(this,"DataCodewords",{get:function(){return this.dataCodewords}})}function r(e,t,n){this.ecCodewordsPerBlock=e,n?this.ecBlocks=new Array(t,n):this.ecBlocks=new Array(t),Object.defineProperty(this,"ECCodewordsPerBlock",{get:function(){return this.ecCodewordsPerBlock}}),Object.defineProperty(this,"TotalECCodewords",{get:function(){return this.ecCodewordsPerBlock*this.NumBlocks}}),Object.defineProperty(this,"NumBlocks",{get:function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}}),this.getECBlocks=function(){return this.ecBlocks}}function i(e,t,n,r,i,s){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=new Array(n,r,i,s);for(var o=0,a=n.ECCodewordsPerBlock,h=n.getECBlocks(),w=0;w<h.length;w++){var f=h[w];o+=f.Count*(f.DataCodewords+a)}this.totalCodewords=o,Object.defineProperty(this,"VersionNumber",{get:function(){return this.versionNumber}}),Object.defineProperty(this,"AlignmentPatternCenters",{get:function(){return this.alignmentPatternCenters}}),Object.defineProperty(this,"TotalCodewords",{get:function(){return this.totalCodewords}}),Object.defineProperty(this,"DimensionForVersion",{get:function(){return 17+4*this.versionNumber}}),this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new u(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;n>r;r++)for(var i=this.alignmentPatternCenters[r]-2,s=0;n>s;s++)0==r&&(0==s||s==n-1)||r==n-1&&0==s||t.setRegion(this.alignmentPatternCenters[s]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}function s(){return new Array(new i(1,new Array,new r(7,new n(1,19)),new r(10,new n(1,16)),new r(13,new n(1,13)),new r(17,new n(1,9))),new i(2,new Array(6,18),new r(10,new n(1,34)),new r(16,new n(1,28)),new r(22,new n(1,22)),new r(28,new n(1,16))),new i(3,new Array(6,22),new r(15,new n(1,55)),new r(26,new n(1,44)),new r(18,new n(2,17)),new r(22,new n(2,13))),new i(4,new Array(6,26),new r(20,new n(1,80)),new r(18,new n(2,32)),new r(26,new n(2,24)),new r(16,new n(4,9))),new i(5,new Array(6,30),new r(26,new n(1,108)),new r(24,new n(2,43)),new r(18,new n(2,15),new n(2,16)),new r(22,new n(2,11),new n(2,12))),new i(6,new Array(6,34),new r(18,new n(2,68)),new r(16,new n(4,27)),new r(24,new n(4,19)),new r(28,new n(4,15))),new i(7,new Array(6,22,38),new r(20,new n(2,78)),new r(18,new n(4,31)),new r(18,new n(2,14),new n(4,15)),new r(26,new n(4,13),new n(1,14))),new i(8,new Array(6,24,42),new r(24,new n(2,97)),new r(22,new n(2,38),new n(2,39)),new r(22,new n(4,18),new n(2,19)),new r(26,new n(4,14),new n(2,15))),new i(9,new Array(6,26,46),new r(30,new n(2,116)),new r(22,new n(3,36),new n(2,37)),new r(20,new n(4,16),new n(4,17)),new r(24,new n(4,12),new n(4,13))),new i(10,new Array(6,28,50),new r(18,new n(2,68),new n(2,69)),new r(26,new n(4,43),new n(1,44)),new r(24,new n(6,19),new n(2,20)),new r(28,new n(6,15),new n(2,16))),new i(11,new Array(6,30,54),new r(20,new n(4,81)),new r(30,new n(1,50),new n(4,51)),new r(28,new n(4,22),new n(4,23)),new r(24,new n(3,12),new n(8,13))),new i(12,new Array(6,32,58),new r(24,new n(2,92),new n(2,93)),new r(22,new n(6,36),new n(2,37)),new r(26,new n(4,20),new n(6,21)),new r(28,new n(7,14),new n(4,15))),new i(13,new Array(6,34,62),new r(26,new n(4,107)),new r(22,new n(8,37),new n(1,38)),new r(24,new n(8,20),new n(4,21)),new r(22,new n(12,11),new n(4,12))),new i(14,new Array(6,26,46,66),new r(30,new n(3,115),new n(1,116)),new r(24,new n(4,40),new n(5,41)),new r(20,new n(11,16),new n(5,17)),new r(24,new n(11,12),new n(5,13))),new i(15,new Array(6,26,48,70),new r(22,new n(5,87),new n(1,88)),new r(24,new n(5,41),new n(5,42)),new r(30,new n(5,24),new n(7,25)),new r(24,new n(11,12),new n(7,13))),new i(16,new Array(6,26,50,74),new r(24,new n(5,98),new n(1,99)),new r(28,new n(7,45),new n(3,46)),new r(24,new n(15,19),new n(2,20)),new r(30,new n(3,15),new n(13,16))),new i(17,new Array(6,30,54,78),new r(28,new n(1,107),new n(5,108)),new r(28,new n(10,46),new n(1,47)),new r(28,new n(1,22),new n(15,23)),new r(28,new n(2,14),new n(17,15))),new i(18,new Array(6,30,56,82),new r(30,new n(5,120),new n(1,121)),new r(26,new n(9,43),new n(4,44)),new r(28,new n(17,22),new n(1,23)),new r(28,new n(2,14),new n(19,15))),new i(19,new Array(6,30,58,86),new r(28,new n(3,113),new n(4,114)),new r(26,new n(3,44),new n(11,45)),new r(26,new n(17,21),new n(4,22)),new r(26,new n(9,13),new n(16,14))),new i(20,new Array(6,34,62,90),new r(28,new n(3,107),new n(5,108)),new r(26,new n(3,41),new n(13,42)),new r(30,new n(15,24),new n(5,25)),new r(28,new n(15,15),new n(10,16))),new i(21,new Array(6,28,50,72,94),new r(28,new n(4,116),new n(4,117)),new r(26,new n(17,42)),new r(28,new n(17,22),new n(6,23)),new r(30,new n(19,16),new n(6,17))),new i(22,new Array(6,26,50,74,98),new r(28,new n(2,111),new n(7,112)),new r(28,new n(17,46)),new r(30,new n(7,24),new n(16,25)),new r(24,new n(34,13))),new i(23,new Array(6,30,54,74,102),new r(30,new n(4,121),new n(5,122)),new r(28,new n(4,47),new n(14,48)),new r(30,new n(11,24),new n(14,25)),new r(30,new n(16,15),new n(14,16))),new i(24,new Array(6,28,54,80,106),new r(30,new n(6,117),new n(4,118)),new r(28,new n(6,45),new n(14,46)),new r(30,new n(11,24),new n(16,25)),new r(30,new n(30,16),new n(2,17))),new i(25,new Array(6,32,58,84,110),new r(26,new n(8,106),new n(4,107)),new r(28,new n(8,47),new n(13,48)),new r(30,new n(7,24),new n(22,25)),new r(30,new n(22,15),new n(13,16))),new i(26,new Array(6,30,58,86,114),new r(28,new n(10,114),new n(2,115)),new r(28,new n(19,46),new n(4,47)),new r(28,new n(28,22),new n(6,23)),new r(30,new n(33,16),new n(4,17))),new i(27,new Array(6,34,62,90,118),new r(30,new n(8,122),new n(4,123)),new r(28,new n(22,45),new n(3,46)),new r(30,new n(8,23),new n(26,24)),new r(30,new n(12,15),new n(28,16))),new i(28,new Array(6,26,50,74,98,122),new r(30,new n(3,117),new n(10,118)),new r(28,new n(3,45),new n(23,46)),new r(30,new n(4,24),new n(31,25)),new r(30,new n(11,15),new n(31,16))),new i(29,new Array(6,30,54,78,102,126),new r(30,new n(7,116),new n(7,117)),new r(28,new n(21,45),new n(7,46)),new r(30,new n(1,23),new n(37,24)),new r(30,new n(19,15),new n(26,16))),new i(30,new Array(6,26,52,78,104,130),new r(30,new n(5,115),new n(10,116)),new r(28,new n(19,47),new n(10,48)),new r(30,new n(15,24),new n(25,25)),new r(30,new n(23,15),new n(25,16))),new i(31,new Array(6,30,56,82,108,134),new r(30,new n(13,115),new n(3,116)),new r(28,new n(2,46),new n(29,47)),new r(30,new n(42,24),new n(1,25)),new r(30,new n(23,15),new n(28,16))),new i(32,new Array(6,34,60,86,112,138),new r(30,new n(17,115)),new r(28,new n(10,46),new n(23,47)),new r(30,new n(10,24),new n(35,25)),new r(30,new n(19,15),new n(35,16))),new i(33,new Array(6,30,58,86,114,142),new r(30,new n(17,115),new n(1,116)),new r(28,new n(14,46),new n(21,47)),new r(30,new n(29,24),new n(19,25)),new r(30,new n(11,15),new n(46,16))),new i(34,new Array(6,34,62,90,118,146),new r(30,new n(13,115),new n(6,116)),new r(28,new n(14,46),new n(23,47)),new r(30,new n(44,24),new n(7,25)),new r(30,new n(59,16),new n(1,17))),new i(35,new Array(6,30,54,78,102,126,150),new r(30,new n(12,121),new n(7,122)),new r(28,new n(12,47),new n(26,48)),new r(30,new n(39,24),new n(14,25)),new r(30,new n(22,15),new n(41,16))),new i(36,new Array(6,24,50,76,102,128,154),new r(30,new n(6,121),new n(14,122)),new r(28,new n(6,47),new n(34,48)),new r(30,new n(46,24),new n(10,25)),new r(30,new n(2,15),new n(64,16))),new i(37,new Array(6,28,54,80,106,132,158),new r(30,new n(17,122),new n(4,123)),new r(28,new n(29,46),new n(14,47)),new r(30,new n(49,24),new n(10,25)),new r(30,new n(24,15),new n(46,16))),new i(38,new Array(6,32,58,84,110,136,162),new r(30,new n(4,122),new n(18,123)),new r(28,new n(13,46),new n(32,47)),new r(30,new n(48,24),new n(14,25)),new r(30,new n(42,15),new n(32,16))),new i(39,new Array(6,26,54,82,110,138,166),new r(30,new n(20,117),new n(4,118)),new r(28,new n(40,47),new n(7,48)),new r(30,new n(43,24),new n(22,25)),new r(30,new n(10,15),new n(67,16))),new i(40,new Array(6,30,58,86,114,142,170),new r(30,new n(19,118),new n(6,119)),new r(28,new n(18,47),new n(31,48)),new r(30,new n(34,24),new n(34,25)),new r(30,new n(20,15),new n(61,16))))}function o(e,t,n,r,i,s,a,h,w){this.a11=e,this.a12=r,this.a13=a,this.a21=t,this.a22=i,this.a23=h,this.a31=n,this.a32=s,this.a33=w,this.transformPoints1=function(e){for(var t=e.length,n=this.a11,r=this.a12,i=this.a13,s=this.a21,o=this.a22,a=this.a23,h=this.a31,w=this.a32,f=this.a33,u=0;t>u;u+=2){var d=e[u],l=e[u+1],c=i*d+a*l+f;e[u]=(n*d+s*l+h)/c,e[u+1]=(r*d+o*l+w)/c}},this.transformPoints2=function(e,t){for(var n=e.length,r=0;n>r;r++){var i=e[r],s=t[r],o=this.a13*i+this.a23*s+this.a33;e[r]=(this.a11*i+this.a21*s+this.a31)/o,t[r]=(this.a12*i+this.a22*s+this.a32)/o}},this.buildAdjoint=function(){return new o(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new o(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}function a(e,t){this.bits=e,this.points=t}function h(e){this.image=e,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(t,n,r,i){var s=Math.abs(i-n)>Math.abs(r-t);if(s){var o=t;t=n,n=o,o=r,r=i,i=o}for(var a=Math.abs(r-t),h=Math.abs(i-n),w=-a>>1,f=i>n?1:-1,u=r>t?1:-1,d=0,l=t,c=n;l!=r;l+=u){var g=s?c:l,v=s?l:c;if(1==d?this.image.data[g+v*e.width]&&d++:this.image.data[g+v*e.width]||d++,3==d){var m=l-t,y=c-n;return Math.sqrt(m*m+y*y)}if(w+=h,w>0){if(c==i)break;c+=f,w-=a}}var b=r-t,p=i-n;return Math.sqrt(b*b+p*p)},this.sizeOfBlackWhiteBlackRunBothWays=function(t,n,r,i){var s=this.sizeOfBlackWhiteBlackRun(t,n,r,i),o=1,a=t-(r-t);0>a?(o=t/(t-a),a=0):a>=e.width&&(o=(e.width-1-t)/(a-t),a=e.width-1);var h=Math.floor(n-(i-n)*o);return o=1,0>h?(o=n/(n-h),h=0):h>=e.height&&(o=(e.height-1-n)/(h-n),h=e.height-1),a=Math.floor(t+(a-t)*o),s+=this.sizeOfBlackWhiteBlackRun(t,n,a,h),s-1},this.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14},this.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},this.distance=function(e,t){return xDiff=e.X-t.X,yDiff=e.Y-t.Y,Math.sqrt(xDiff*xDiff+yDiff*yDiff)},this.computeDimension=function(e,t,n,r){var i=Math.round(this.distance(e,t)/r),s=Math.round(this.distance(e,n)/r),o=(i+s>>1)+7;switch(3&o){case 0:o++;break;case 2:o--;break;case 3:throw"Error"}return o},this.findAlignmentInRegion=function(t,n,r,i){var s=Math.floor(i*t),o=Math.max(0,n-s),a=Math.min(e.width-1,n+s);if(3*t>a-o)throw"Error";var h=Math.max(0,r-s),w=Math.min(e.height-1,r+s),f=new x(this.image,o,h,a-o,w-h,t,this.resultPointCallback);return f.find()},this.createTransform=function(e,t,n,r,i){var s,a,h,w,f=i-3.5;null!=r?(s=r.X,a=r.Y,h=w=f-3):(s=t.X-e.X+n.X,a=t.Y-e.Y+n.Y,h=w=f);var u=o.quadrilateralToQuadrilateral(3.5,3.5,f,3.5,h,w,3.5,f,e.X,e.Y,t.X,t.Y,s,a,n.X,n.Y);return u},this.sampleGrid=function(e,t,n){var r=O;return r.sampleGrid3(e,n,t)},this.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight,r=e.BottomLeft,s=this.calculateModuleSize(t,n,r);if(1>s)throw"Error";var o=this.computeDimension(t,n,r,s),h=i.getProvisionalVersionForDimension(o),w=h.DimensionForVersion-7,f=null;if(h.AlignmentPatternCenters.length>0)for(var u=n.X-t.X+r.X,d=n.Y-t.Y+r.Y,l=1-3/w,c=Math.floor(t.X+l*(u-t.X)),g=Math.floor(t.Y+l*(d-t.Y)),v=4;16>=v;v<<=1){f=this.findAlignmentInRegion(s,c,g,v);break}var m,y=this.createTransform(t,n,r,f,o),b=this.sampleGrid(this.image,y,o);return m=null==f?new Array(r,t,n):new Array(r,t,n,f),new a(b,m)},this.detect=function(){var e=(new S).findFinderPattern(this.image);return this.processFinderPatternInfo(e)}}function w(e){this.errorCorrectionLevel=f.forBits(e>>3&3),this.dataMask=7&e,Object.defineProperty(this,"ErrorCorrectionLevel",{get:function(){return this.errorCorrectionLevel}}),Object.defineProperty(this,"DataMask",{get:function(){return this.dataMask}}),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|dataMask},this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask}}function f(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n,Object.defineProperty(this,"Bits",{get:function(){return this.bits}}),Object.defineProperty(this,"Name",{get:function(){return this.name}}),this.ordinal=function(){return this.ordinal_Renamed_Field}}function u(e,t){if(t||(t=e),1>e||1>t)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;0!=(31&e)&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var r=0;r<this.bits.length;r++)this.bits[r]=0;Object.defineProperty(this,"Width",{get:function(){return this.width}}),Object.defineProperty(this,"Height",{get:function(){return this.height}}),Object.defineProperty(this,"Dimension",{get:function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}}),this.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return 0!=(1&k(this.bits[n],31&e))},this.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(31&e)},this.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;e>t;t++)this.bits[t]=0},this.setRegion=function(e,t,n,r){if(0>t||0>e)throw"Left and top must be nonnegative";if(1>r||1>n)throw"Height and width must be at least 1";var i=e+n,s=t+r;if(s>this.height||i>this.width)throw"The region must fit inside the matrix";for(var o=t;s>o;o++)for(var a=o*this.rowSize,h=e;i>h;h++)this.bits[a+(h>>5)]|=1<<(31&h)}}function d(e,t){this.numDataCodewords=e,this.codewords=t,Object.defineProperty(this,"NumDataCodewords",{get:function(){return this.numDataCodewords}}),Object.defineProperty(this,"Codewords",{get:function(){return this.codewords}})}function l(e){var t=e.Dimension;if(21>t||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;6>t;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=w.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var r=this.bitMatrix.Dimension;e=0;for(var i=r-8,t=r-1;t>=i;t--)e=this.copyBit(t,8,e);for(var n=r-7;r>n;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=w.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(6>=t)return i.getVersionForNumber(t);for(var n=0,r=e-11,s=5;s>=0;s--)for(var o=e-9;o>=r;o--)n=this.copyBit(o,s,n);if(this.parsedVersion=i.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;n=0;for(var o=5;o>=0;o--)for(var s=e-9;s>=r;s--)n=this.copyBit(o,s,n);if(this.parsedVersion=i.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=V.forReference(e.DataMask),r=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,r);for(var i=t.buildFunctionPattern(),s=!0,o=new Array(t.TotalCodewords),a=0,h=0,w=0,f=r-1;f>0;f-=2){6==f&&f--;for(var u=0;r>u;u++)for(var d=s?r-1-u:u,l=0;2>l;l++)i.get_Renamed(f-l,d)||(w++,h<<=1,this.bitMatrix.get_Renamed(f-l,d)&&(h|=1),8==w&&(o[a++]=h,w=0,h=0));s^=!0}if(a!=t.TotalCodewords)throw"Error readCodewords";return o}}function c(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(e+t&1)}}function g(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(1&e)}}function v(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return t%3==0}}function m(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e+t)%3==0}}function y(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(k(e,1)+t/3&1)}}function b(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return(1&n)+n%3==0}}function p(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return 0==((1&n)+n%3&1)}}function C(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}}function A(e){this.field=e,this.decode=function(e,t){for(var n=new M(this.field,e),r=new Array(t),i=0;i<r.length;i++)r[i]=0;for(var s=!1,o=!0,i=0;t>i;i++){var a=n.evaluateAt(this.field.exp(s?i+1:i));r[r.length-1-i]=a,0!=a&&(o=!1)}if(!o)for(var h=new M(this.field,r),w=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),h,t),f=w[0],u=w[1],d=this.findErrorLocations(f),l=this.findErrorMagnitudes(u,d,s),i=0;i<d.length;i++){var c=e.length-1-this.field.log(d[i]);if(0>c)throw"ReedSolomonException Bad error location";e[c]=P.addOrSubtract(e[c],l[i])}},this.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var r=e;e=t,t=r}for(var i=e,s=t,o=this.field.One,a=this.field.Zero,h=this.field.Zero,w=this.field.One;s.Degree>=Math.floor(n/2);){var f=i,u=o,d=h;if(i=s,o=a,h=w,i.Zero)throw"r_{i-1} was zero";s=f;for(var l=this.field.Zero,c=i.getCoefficient(i.Degree),g=this.field.inverse(c);s.Degree>=i.Degree&&!s.Zero;){var v=s.Degree-i.Degree,m=this.field.multiply(s.getCoefficient(s.Degree),g);l=l.addOrSubtract(this.field.buildMonomial(v,m)),s=s.addOrSubtract(i.multiplyByMonomial(v,m))}a=l.multiply1(o).addOrSubtract(u),w=l.multiply1(h).addOrSubtract(d)}var y=w.getCoefficient(0);if(0==y)throw"ReedSolomonException sigmaTilde(0) was zero";var b=this.field.inverse(y),p=w.multiply2(b),C=s.multiply2(b);return new Array(p,C)},this.findErrorLocations=function(e){var t=e.Degree;if(1==t)return new Array(e.getCoefficient(1));for(var n=new Array(t),r=0,i=1;256>i&&t>r;i++)0==e.evaluateAt(i)&&(n[r]=this.field.inverse(i),r++);if(r!=t)throw"Error locator degree does not match number of roots";return n},this.findErrorMagnitudes=function(e,t,n){for(var r=t.length,i=new Array(r),s=0;r>s;s++){for(var o=this.field.inverse(t[s]),a=1,h=0;r>h;h++)s!=h&&(a=this.field.multiply(a,P.addOrSubtract(1,this.field.multiply(t[h],o))));i[s]=this.field.multiply(e.evaluateAt(o),this.field.inverse(a)),n&&(i[s]=this.field.multiply(i[s],o))}return i}}function M(e,t){if(null==t||0==t.length)throw"System.ArgumentException";this.field=e;var n=t.length;if(n>1&&0==t[0]){for(var r=1;n>r&&0==t[r];)r++;if(r==n)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(n-r);for(var i=0;i<this.coefficients.length;i++)this.coefficients[i]=0;for(var s=0;s<this.coefficients.length;s++)this.coefficients[s]=t[r+s]}}else this.coefficients=t;Object.defineProperty(this,"Zero",{get:function(){return 0==this.coefficients[0]}}),Object.defineProperty(this,"Degree",{get:function(){return this.coefficients.length-1}}),Object.defineProperty(this,"Coefficients",{get:function(){return this.coefficients}}),this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},this.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var n=0,r=0;t>r;r++)n=P.addOrSubtract(n,this.coefficients[r]);return n}for(var i=this.coefficients[0],r=1;t>r;r++)i=P.addOrSubtract(this.field.multiply(e,i),this.coefficients[r]);return i},this.addOrSubtract=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return t;if(t.Zero)return this;var n=this.coefficients,r=t.coefficients;if(n.length>r.length){var i=n;n=r,r=i}for(var s=new Array(r.length),o=r.length-n.length,a=0;o>a;a++)s[a]=r[a];for(var h=o;h<r.length;h++)s[h]=P.addOrSubtract(n[h-o],r[h]);return new M(e,s)},this.multiply1=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||e.Zero)return this.field.Zero;for(var t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,s=new Array(n+i-1),o=0;n>o;o++)for(var a=t[o],h=0;i>h;h++)s[o+h]=P.addOrSubtract(s[o+h],this.field.multiply(a,r[h]));return new M(this.field,s)},this.multiply2=function(e){if(0==e)return this.field.Zero;if(1==e)return this;for(var t=this.coefficients.length,n=new Array(t),r=0;t>r;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new M(this.field,n)},this.multiplyByMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return this.field.Zero;for(var n=this.coefficients.length,r=new Array(n+e),i=0;i<r.length;i++)r[i]=0;for(var i=0;n>i;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new M(this.field,r)},this.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,r=e.getCoefficient(e.Degree),i=this.field.inverse(r);n.Degree>=e.Degree&&!n.Zero;){var s=n.Degree-e.Degree,o=this.field.multiply(n.getCoefficient(n.Degree),i),a=e.multiplyByMonomial(s,o),h=this.field.buildMonomial(s,o);t=t.addOrSubtract(h),n=n.addOrSubtract(a)}return new Array(t,n)}}function P(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;256>n;n++)this.expTable[n]=t,t<<=1,t>=256&&(t^=e);for(var n=0;255>n;n++)this.logTable[this.expTable[n]]=n;var r=new Array(1);r[0]=0,this.zero=new M(this,new Array(r));var i=new Array(1);i[0]=1,this.one=new M(this,new Array(i)),Object.defineProperty(this,"Zero",{get:function(){return this.zero}}),Object.defineProperty(this,"One",{get:function(){return this.one}}),this.buildMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return zero;for(var n=new Array(e+1),r=0;r<n.length;r++)n[r]=0;return n[0]=t,new M(this,n)},this.exp=function(e){return this.expTable[e]},this.log=function(e){if(0==e)throw"System.ArgumentException";return this.logTable[e]},this.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]}}function k(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}function N(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,Object.defineProperty(this,"EstimatedModuleSize",{get:function(){return this.estimatedModuleSize}}),Object.defineProperty(this,"Count",{get:function(){return this.count}}),Object.defineProperty(this,"X",{get:function(){return this.x}}),Object.defineProperty(this,"Y",{get:function(){return this.y}}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return 1>=r||r/this.estimatedModuleSize<=1}return!1}}function B(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2],Object.defineProperty(this,"BottomLeft",{get:function(){return this.bottomLeft}}),Object.defineProperty(this,"TopLeft",{get:function(){return this.topLeft}}),Object.defineProperty(this,"TopRight",{get:function(){return this.topRight}})}function S(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=new Array(0,0,0,0,0),this.resultPointCallback=null,Object.defineProperty(this,"CrossCheckStateCount",{get:function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}}),this.foundPatternCross=function(e){for(var t=0,n=0;5>n;n++){var r=e[n];if(0==r)return!1;t+=r}if(7>t)return!1;var i=Math.floor((t<<_)/7),s=Math.floor(i/2);return Math.abs(i-(e[0]<<_))<s&&Math.abs(i-(e[1]<<_))<s&&Math.abs(3*i-(e[2]<<_))<3*s&&Math.abs(i-(e[3]<<_))<s&&Math.abs(i-(e[4]<<_))<s},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(e,t,n,r){for(var i=this.image,s=i.height,o=this.CrossCheckStateCount,a=e;a>=0&&i.data[t+a*i.width];)o[2]++,a--;if(0>a)return NaN;for(;a>=0&&!i.data[t+a*i.width]&&o[1]<=n;)o[1]++,a--;if(0>a||o[1]>n)return NaN;for(;a>=0&&i.data[t+a*i.width]&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;s>a&&i.data[t+a*i.width];)o[2]++,a++;if(a==s)return NaN;for(;s>a&&!i.data[t+a*i.width]&&o[3]<n;)o[3]++,a++;if(a==s||o[3]>=n)return NaN;for(;s>a&&i.data[t+a*i.width]&&o[4]<n;)o[4]++,a++;if(o[4]>=n)return NaN;var h=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(h-r)>=2*r?NaN:this.foundPatternCross(o)?this.centerFromEnd(o,a):NaN},this.crossCheckHorizontal=function(e,t,n,r){for(var i=this.image,s=i.width,o=this.CrossCheckStateCount,a=e;a>=0&&i.data[a+t*i.width];)o[2]++,a--;if(0>a)return NaN;for(;a>=0&&!i.data[a+t*i.width]&&o[1]<=n;)o[1]++,a--;if(0>a||o[1]>n)return NaN;for(;a>=0&&i.data[a+t*i.width]&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;s>a&&i.data[a+t*i.width];)o[2]++,a++;if(a==s)return NaN;for(;s>a&&!i.data[a+t*i.width]&&o[3]<n;)o[3]++,a++;if(a==s||o[3]>=n)return NaN;for(;s>a&&i.data[a+t*i.width]&&o[4]<n;)o[4]++,a++;if(o[4]>=n)return NaN;var h=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(h-r)>=r?NaN:this.foundPatternCross(o)?this.centerFromEnd(o,a):NaN},this.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2]+e[3]+e[4],i=this.centerFromEnd(e,n),s=this.crossCheckVertical(t,Math.floor(i),e[2],r);if(!isNaN(s)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(s),e[2],r),!isNaN(i))){for(var o=r/7,a=!1,h=this.possibleCenters.length,w=0;h>w;w++){var f=this.possibleCenters[w];if(f.aboutEquals(o,s,i)){f.incrementCount(),a=!0;break}}if(!a){var u=new N(i,s,o);this.possibleCenters.push(u),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(u)}return!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(3>e)throw"Couldn't find enough finder patterns:"+e+" patterns found";if(e>3){for(var t=0,n=0,r=0;e>r;r++){var i=this.possibleCenters[r].EstimatedModuleSize;t+=i,n+=i*i}var s=t/e;this.possibleCenters.sort(function(e,t){var n=Math.abs(t.EstimatedModuleSize-s),r=Math.abs(e.EstimatedModuleSize-s);return r>n?-1:n==r?0:1});for(var o=Math.sqrt(n/e-s*s),a=Math.max(.2*s,o),r=0;r<this.possibleCenters.length&&this.possibleCenters.length>3;r++){var h=this.possibleCenters[r];Math.abs(h.EstimatedModuleSize-s)>a&&(this.possibleCenters.splice(r,1),r--)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),new Array(this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2])},this.findRowSkip=function(){var e=this.possibleCenters.length;if(1>=e)return 0;for(var t=null,n=0;e>n;n++){var r=this.possibleCenters[n];if(r.Count>=Y){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2);t=r}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,r=0;n>r;r++){var i=this.possibleCenters[r];i.Count>=Y&&(e++,t+=i.EstimatedModuleSize)}if(3>e)return!1;for(var s=t/n,o=0,r=0;n>r;r++)i=this.possibleCenters[r],o+=Math.abs(i.EstimatedModuleSize-s);return.05*t>=o},this.findFinderPattern=function(e){var t=!1;this.image=e;var n=e.height,r=e.width,i=Math.floor(3*n/(4*X));(j>i||t)&&(i=j);for(var s=!1,o=new Array(5),a=i-1;n>a&&!s;a+=i){o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0;for(var h=0,w=0;r>w;w++)if(e.data[w+a*e.width])1==(1&h)&&h++,o[h]++;else if(0==(1&h))if(4==h)if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,a,w);if(f)if(i=2,this.hasSkipped)s=this.haveMultiplyConfirmedCenters();else{var u=this.findRowSkip();u>o[2]&&(a+=u-o[2]-i,w=r-1)}else{do w++;while(r>w&&!e.data[w+a*e.width]);w--}h=0,o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0}else o[0]=o[2],o[1]=o[3],o[2]=o[4],o[3]=1,o[4]=0,h=3;else o[++h]++;else o[h]++;if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,a,r);f&&(i=o[0],this.hasSkipped&&(s=haveMultiplyConfirmedCenters()))}}var d=this.selectBestPatterns();return T.orderBestPatterns(d),new B(d)}}function D(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,Object.defineProperty(this,"EstimatedModuleSize",{get:function(){return this.estimatedModuleSize}}),Object.defineProperty(this,"Count",{get:function(){return this.count}}),Object.defineProperty(this,"X",{get:function(){return Math.floor(this.x)}}),Object.defineProperty(this,"Y",{get:function(){return Math.floor(this.y)}}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return 1>=r||r/this.estimatedModuleSize<=1}return!1}}function x(e,t,n,r,i,s,o){this.image=e,this.possibleCenters=new Array,this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=s,this.crossCheckStateCount=new Array(0,0,0),this.resultPointCallback=o,this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,r=0;3>r;r++)if(Math.abs(t-e[r])>=n)return!1;return!0},this.crossCheckVertical=function(e,t,n,r){var i=this.image,s=i.height,o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;for(var a=e;a>=0&&i.data[t+a*i.width]&&o[1]<=n;)o[1]++,a--;if(0>a||o[1]>n)return NaN;for(;a>=0&&!i.data[t+a*i.width]&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;s>a&&i.data[t+a*i.width]&&o[1]<=n;)o[1]++,a++;if(a==s||o[1]>n)return NaN;for(;s>a&&!i.data[t+a*i.width]&&o[2]<=n;)o[2]++,a++;if(o[2]>n)return NaN;var h=o[0]+o[1]+o[2];return 5*Math.abs(h-r)>=2*r?NaN:this.foundPatternCross(o)?this.centerFromEnd(o,a):NaN},this.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2],i=this.centerFromEnd(e,n),s=this.crossCheckVertical(t,Math.floor(i),2*e[1],r);if(!isNaN(s)){for(var o=(e[0]+e[1]+e[2])/3,a=this.possibleCenters.length,h=0;a>h;h++){var w=this.possibleCenters[h];if(w.aboutEquals(o,s,i))return new D(i,s,o)}var f=new D(i,s,o);this.possibleCenters.push(f),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(f)}return null},this.find=function(){for(var t=this.startX,i=this.height,s=t+r,o=n+(i>>1),a=new Array(0,0,0),h=0;i>h;h++){
var w=o+(0==(1&h)?h+1>>1:-(h+1>>1));a[0]=0,a[1]=0,a[2]=0;for(var f=t;s>f&&!e.data[f+e.width*w];)f++;for(var u=0;s>f;){if(e.data[f+w*e.width])if(1==u)a[u]++;else if(2==u){if(this.foundPatternCross(a)){var d=this.handlePossibleCenter(a,w,f);if(null!=d)return d}a[0]=a[2],a[1]=1,a[2]=0,u=1}else a[++u]++;else 1==u&&u++,a[u]++;f++}if(this.foundPatternCross(a)){var d=this.handlePossibleCenter(a,w,s);if(null!=d)return d}}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"}}function E(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,9>=t?this.dataLengthMode=0:t>=10&&26>=t?this.dataLengthMode=1:t>=27&&40>=t&&(this.dataLengthMode=2),this.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,r=0;e>r;r++)n+=1<<r;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}if(e<this.bitPointer+1+8){for(var i=0,r=0;r<this.bitPointer+1;r++)i+=1<<r;return t=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}if(e<this.bitPointer+1+16){for(var i=0,s=0,r=0;r<this.bitPointer+1;r++)i+=1<<r;var o=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1);this.blockPointer++;var a=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);this.blockPointer++;for(var r=0;r<e-(this.bitPointer+1+8);r++)s+=1<<r;s<<=8-(e-(this.bitPointer+1+8));var h=(this.blocks[this.blockPointer]&s)>>8-(e-(this.bitPointer+1+8));return t=o+a+h,this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(e){for(var t=0;;){if(e>>t==1)break;t++}return this.getNextBits(T.sizeOfDataLengthInfo[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t=e,n=0,r="",i=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do if(t>1){n=this.getNextBits(11);var s=Math.floor(n/45),o=n%45;r+=i[s],r+=i[o],t-=2}else 1==t&&(n=this.getNextBits(6),r+=i[n],t-=1);while(t>0);return r},this.getFigureString=function(e){var t=e,n=0,r="";do t>=3?(n=this.getNextBits(10),100>n&&(r+="0"),10>n&&(r+="0"),t-=3):2==t?(n=this.getNextBits(7),10>n&&(r+="0"),t-=2):1==t&&(n=this.getNextBits(4),t-=1),r+=n;while(t>0);return r},this.get8bitByteArray=function(e){var t=e,n=0,r=new Array;do n=this.getNextBits(8),r.push(n),t--;while(t>0);return r},this.getKanjiString=function(e){var t=e,n=0,r="";do{n=getNextBits(13);var i=n%192,s=n/192,o=(s<<8)+i,a=0;a=40956>=o+33088?o+33088:o+49472,r+=String.fromCharCode(a),t--}while(t>0);return r},Object.defineProperty(this,"DataByte",{get:function(){for(var e=new Array,t=1,n=2,r=4,i=8;;){var s=this.NextMode();if(0==s){if(e.length>0)break;throw"Empty data block"}if(s!=t&&s!=n&&s!=r&&s!=i)throw"Invalid mode: "+s+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";if(dataLength=this.getDataLength(s),dataLength<1)throw"Invalid data length: "+dataLength;switch(s){case t:for(var o=this.getFigureString(dataLength),a=new Array(o.length),h=0;h<o.length;h++)a[h]=o.charCodeAt(h);e.push(a);break;case n:for(var o=this.getRomanAndFigureString(dataLength),a=new Array(o.length),h=0;h<o.length;h++)a[h]=o.charCodeAt(h);e.push(a);break;case r:var w=this.get8bitByteArray(dataLength);e.push(w);break;case i:var o=this.getKanjiString(dataLength);e.push(o)}}return e}})}var O={};O.checkAndNudgePoints=function(e,t){for(var n=e.width,r=e.height,i=!0,s=0;s<t.length&&i;s+=2){var o=Math.floor(t[s]),a=Math.floor(t[s+1]);if(-1>o||o>n||-1>a||a>r)throw"Error.checkAndNudgePoints ";i=!1,-1==o?(t[s]=0,i=!0):o==n&&(t[s]=n-1,i=!0),-1==a?(t[s+1]=0,i=!0):a==r&&(t[s+1]=r-1,i=!0)}i=!0;for(var s=t.length-2;s>=0&&i;s-=2){var o=Math.floor(t[s]),a=Math.floor(t[s+1]);if(-1>o||o>n||-1>a||a>r)throw"Error.checkAndNudgePoints ";i=!1,-1==o?(t[s]=0,i=!0):o==n&&(t[s]=n-1,i=!0),-1==a?(t[s+1]=0,i=!0):a==r&&(t[s+1]=r-1,i=!0)}},O.sampleGrid3=function(e,t,n){for(var r=new u(t),i=new Array(t<<1),s=0;t>s;s++){for(var o=i.length,a=s+.5,h=0;o>h;h+=2)i[h]=(h>>1)+.5,i[h+1]=a;n.transformPoints1(i),O.checkAndNudgePoints(e,i);try{for(var h=0;o>h;h+=2){var w=(4*Math.floor(i[h])+Math.floor(i[h+1])*e.width*4,e.data[Math.floor(i[h])+e.width*Math.floor(i[h+1])]);w&&r.set_Renamed(h>>1,s)}}catch(f){throw"Error.checkAndNudgePoints"}}return r},i.VERSION_DECODE_INFO=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),i.VERSIONS=s(),i.getVersionForNumber=function(e){if(1>e||e>40)throw"ArgumentException";return i.VERSIONS[e-1]},i.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw"Error getProvisionalVersionForDimension";try{return i.getVersionForNumber(e-17>>2)}catch(t){throw"Error getVersionForNumber"}},i.decodeVersionInformation=function(e){for(var t=4294967295,n=0,r=0;r<i.VERSION_DECODE_INFO.length;r++){var s=i.VERSION_DECODE_INFO[r];if(s==e)return this.getVersionForNumber(r+7);var o=w.numBitsDiffering(e,s);t>o&&(n=r+7,t=o)}return 3>=t?this.getVersionForNumber(n):null},o.quadrilateralToQuadrilateral=function(e,t,n,r,i,s,o,a,h,w,f,u,d,l,c,g){var v=this.quadrilateralToSquare(e,t,n,r,i,s,o,a),m=this.squareToQuadrilateral(h,w,f,u,d,l,c,g);return m.times(v)},o.squareToQuadrilateral=function(e,t,n,r,i,s,a,h){return dy2=h-s,dy3=t-r+s-h,0==dy2&&0==dy3?new o(n-e,i-n,e,r-t,s-r,t,0,0,1):(dx1=n-i,dx2=a-i,dx3=e-n+i-a,dy1=r-s,denominator=dx1*dy2-dx2*dy1,a13=(dx3*dy2-dx2*dy3)/denominator,a23=(dx1*dy3-dx3*dy1)/denominator,new o(n-e+a13*n,a-e+a23*a,e,r-t+a13*r,h-t+a23*h,t,a13,a23,1))},o.quadrilateralToSquare=function(e,t,n,r,i,s,o,a){return this.squareToQuadrilateral(e,t,n,r,i,s,o,a).buildAdjoint()};var F=21522,I=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),R=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4);w.numBitsDiffering=function(e,t){return e^=t,R[15&e]+R[15&k(e,4)]+R[15&k(e,8)]+R[15&k(e,12)]+R[15&k(e,16)]+R[15&k(e,20)]+R[15&k(e,24)]+R[15&k(e,28)]},w.decodeFormatInformation=function(e){var t=w.doDecodeFormatInformation(e);return null!=t?t:w.doDecodeFormatInformation(e^F)},w.doDecodeFormatInformation=function(e){for(var t=4294967295,n=0,r=0;r<I.length;r++){var i=I[r],s=i[0];if(s==e)return new w(i[1]);var o=this.numBitsDiffering(e,s);t>o&&(n=i[1],t=o)}return 3>=t?new w(n):null},f.forBits=function(e){if(0>e||e>=z.length)throw"ArgumentException";return z[e]};var z=new Array(new f(1,0,"M"),new f(0,1,"L"),new f(3,2,"H"),new f(2,3,"Q"));d.getDataBlocks=function(e,t,n){if(e.length!=t.TotalCodewords)throw"ArgumentException";for(var r=t.getECBlocksForLevel(n),i=0,s=r.getECBlocks(),o=0;o<s.length;o++)i+=s[o].Count;for(var a=new Array(i),h=0,w=0;w<s.length;w++)for(var f=s[w],o=0;o<f.Count;o++){var u=f.DataCodewords,l=r.ECCodewordsPerBlock+u;a[h++]=new d(u,new Array(l))}for(var c=a[0].codewords.length,g=a.length-1;g>=0;){var v=a[g].codewords.length;if(v==c)break;g--}g++;for(var m=c-r.ECCodewordsPerBlock,y=0,o=0;m>o;o++)for(var w=0;h>w;w++)a[w].codewords[o]=e[y++];for(var w=g;h>w;w++)a[w].codewords[m]=e[y++];for(var b=a[0].codewords.length,o=m;b>o;o++)for(var w=0;h>w;w++){var p=g>w?o:o+1;a[w].codewords[p]=e[y++]}return a};var V={};V.forReference=function(e){if(0>e||e>7)throw"System.ArgumentException";return V.DATA_MASKS[e]},V.DATA_MASKS=new Array(new c,new g,new v,new m,new y,new b,new p,new C),P.QR_CODE_FIELD=new P(285),P.DATA_MATRIX_FIELD=new P(301),P.addOrSubtract=function(e,t){return e^t};var L={};L.rsDecoder=new A(P.QR_CODE_FIELD),L.correctErrors=function(e,t){for(var n=e.length,r=new Array(n),i=0;n>i;i++)r[i]=255&e[i];var s=e.length-t;try{L.rsDecoder.decode(r,s)}catch(o){throw o}for(var i=0;t>i;i++)e[i]=r[i]},L.decode=function(e){for(var t=new l(e),n=t.readVersion(),r=t.readFormatInformation().ErrorCorrectionLevel,i=t.readCodewords(),s=d.getDataBlocks(i,n,r),o=0,a=0;a<s.length;a++)o+=s[a].NumDataCodewords;for(var h=new Array(o),w=0,f=0;f<s.length;f++){var u=s[f],c=u.Codewords,g=u.NumDataCodewords;L.correctErrors(c,g);for(var a=0;g>a;a++)h[w++]=c[a]}var v=new E(h,n.VersionNumber,r.Bits);return v};var T={};T.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],QrCode=function(){this.imagedata=null,this.width=0,this.height=0,this.qrCodeSymbol=null,this.debug=!1,this.callback=null,this.decode=function(e,t){var n=function(){try{this.error=void 0,this.result=this.process(this.imagedata)}catch(e){this.error=e,this.result=void 0}return null!=this.callback&&this.callback(this.result,this.error),this.result}.bind(this);if(void 0==e){var r=document.getElementById("qr-canvas"),i=r.getContext("2d");this.width=r.width,this.height=r.height,this.imagedata=i.getImageData(0,0,this.width,this.height),n()}else if(void 0!=e.width)this.width=e.width,this.height=e.height,this.imagedata={data:t||e.data},this.imagedata.width=e.width,this.imagedata.height=e.height,n();else{var s=new Image;s.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),r=document.getElementById("out-canvas");if(null!=r){var i=r.getContext("2d");i.clearRect(0,0,320,240),i.drawImage(s,0,0,320,240)}e.width=s.width,e.height=s.height,t.drawImage(s,0,0),this.width=s.width,this.height=s.height;try{this.imagedata=t.getImageData(0,0,s.width,s.height)}catch(o){if(this.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",null!=this.callback)return this.callback(this.result)}n()}.bind(this),s.src=e}},this.decode_utf8=function(e){return decodeURIComponent(escape(e))},this.process=function(e){for(var t=(new Date).getTime(),n=this.grayScaleToBitmap(this.grayscale(e)),r=new h(n),i=r.detect(),s=L.decode(i.bits),o=s.DataByte,a="",w=0;w<o.length;w++)for(var f=0;f<o[w].length;f++)a+=String.fromCharCode(o[w][f]);var u=(new Date).getTime(),d=u-t;return this.debug&&console.log("QR Code processing time (ms): "+d),this.decode_utf8(a)},this.getPixel=function(e,t,n){if(e.width<t)throw"point error";if(e.height<n)throw"point error";var r=4*t+n*e.width*4;return(33*e.data[r]+34*e.data[r+1]+33*e.data[r+2])/100},this.binarize=function(e){for(var t=new Array(this.width*this.height),n=0;n<this.height;n++)for(var r=0;r<this.width;r++){var i=this.getPixel(r,n);t[r+n*this.width]=e>=i}return t},this.getMiddleBrightnessPerArea=function(e){for(var t=4,n=Math.floor(e.width/t),r=Math.floor(e.height/t),i=new Array(t),s=0;t>s;s++){i[s]=new Array(t);for(var o=0;t>o;o++)i[s][o]=new Array(0,0)}for(var a=0;t>a;a++)for(var h=0;t>h;h++){i[h][a][0]=255;for(var w=0;r>w;w++)for(var f=0;n>f;f++){var u=e.data[n*h+f+(r*a+w)*e.width];u<i[h][a][0]&&(i[h][a][0]=u),u>i[h][a][1]&&(i[h][a][1]=u)}}for(var d=new Array(t),l=0;t>l;l++)d[l]=new Array(t);for(var a=0;t>a;a++)for(var h=0;t>h;h++)d[h][a]=Math.floor((i[h][a][0]+i[h][a][1])/2);return d},this.grayScaleToBitmap=function(e){for(var t=this.getMiddleBrightnessPerArea(e),n=t.length,r=Math.floor(e.width/n),i=Math.floor(e.height/n),s=0;n>s;s++)for(var o=0;n>o;o++)for(var a=0;i>a;a++)for(var h=0;r>h;h++)e.data[r*o+h+(i*s+a)*e.width]=e.data[r*o+h+(i*s+a)*e.width]<t[o][s];return e},this.grayscale=function(e){for(var t=new Array(e.width*e.height),n=0;n<e.height;n++)for(var r=0;r<e.width;r++){var i=this.getPixel(e,r,n);t[r+n*e.width]=i}return{height:e.height,width:e.width,data:t}}};var j=3,X=57,_=8,Y=2;T.orderBestPatterns=function(e){function t(e,t){return xDiff=e.X-t.X,yDiff=e.Y-t.Y,Math.sqrt(xDiff*xDiff+yDiff*yDiff)}function n(e,t,n){var r=t.x,i=t.y;return(n.x-r)*(e.y-i)-(n.y-i)*(e.x-r)}var r,i,s,o=t(e[0],e[1]),a=t(e[1],e[2]),h=t(e[0],e[2]);if(a>=o&&a>=h?(i=e[0],r=e[1],s=e[2]):h>=a&&h>=o?(i=e[1],r=e[0],s=e[2]):(i=e[2],r=e[0],s=e[1]),n(r,i,s)<0){var w=r;r=s,s=w}e[0]=r,e[1]=i,e[2]=s},e.exports=QrCode}]);